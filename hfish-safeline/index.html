<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="mask-icon" href="/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.ceobe.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"width":300},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"static","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="雷池Safeline是一个基于智能语义分析引擎的下一代Web应用防火墙（WAF）。HFish是一款社区型免费蜜罐，侧重企业安全场景，从内网失陷检测、外网威胁感知、威胁情报生产三个场景出发，为用户提供可独立操作且实用的功能，通过安全、敏捷、可靠的中低交互蜜罐增加用户在失陷感知和威胁情报领域的能力。本篇将通过结合WAF与蜜罐实现对互联网攻击的主动防范。">
<meta property="og:type" content="article">
<meta property="og:title" content="雷池Safeline&amp;HFish主动防御方案">
<meta property="og:url" content="https://blog.ceobe.cn/hfish-safeline/">
<meta property="og:site_name" content="Ceobe&#39;s Fungimist">
<meta property="og:description" content="雷池Safeline是一个基于智能语义分析引擎的下一代Web应用防火墙（WAF）。HFish是一款社区型免费蜜罐，侧重企业安全场景，从内网失陷检测、外网威胁感知、威胁情报生产三个场景出发，为用户提供可独立操作且实用的功能，通过安全、敏捷、可靠的中低交互蜜罐增加用户在失陷感知和威胁情报领域的能力。本篇将通过结合WAF与蜜罐实现对互联网攻击的主动防范。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201150146817.png">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201150100393.png">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/er.png">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201143147891.png">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201150403087.png">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201150428430.png">
<meta property="og:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201150331151.png">
<meta property="article:published_time" content="2024-02-01T07:23:36.000Z">
<meta property="article:modified_time" content="2024-02-01T07:23:10.000Z">
<meta property="article:author" content="Melt_Tscci">
<meta property="article:tag" content="安全合规">
<meta property="article:tag" content="WAF">
<meta property="article:tag" content="蜜罐技术">
<meta property="article:tag" content="主动防御">
<meta property="article:tag" content="事件响应">
<meta property="article:tag" content="防火墙">
<meta property="article:tag" content="应用程序安全">
<meta property="article:tag" content="风险评估">
<meta property="article:tag" content="网络安全">
<meta property="article:tag" content="钓鱼攻击">
<meta property="article:tag" content="恶意软件">
<meta property="article:tag" content="威胁情报">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.ceobe.cn/hfish-safeline/image-20240201150146817.png">


<link rel="canonical" href="https://blog.ceobe.cn/hfish-safeline/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.ceobe.cn/hfish-safeline/","path":"hfish-safeline/","title":"雷池Safeline&HFish主动防御方案"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>雷池Safeline&HFish主动防御方案 | Ceobe's Fungimist</title>
  







  <script defer data-domain="blog.ceobe.cn" src="https://plausible.ceobe.cn/js/script.js"></script>
<link rel="dns-prefetch" href="https://waline.ceobe.cn/">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Ceobe's Fungimist" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Ceobe's Fungimist</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">轻尘散尽,绪言终古,于无声处听惊雷.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-schedule"><a href="https://ceobe.notion.site/ceobe/764e6257f2064f499fb5993112136a43?v=8b7437d14ec64e3cb3678fa89003b5b6" rel="section" target="_blank"><i class="fa fa-calendar fa-fw"></i>日程表</a></li><li class="menu-item menu-item-开往"><a href="https://www.travellings.cn/go.html" rel="section" target="_blank"><i class="fa fa-subway fa-fw"></i>开往</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9B%B7%E6%B1%A0Safeline-HFish%E4%B8%BB%E5%8A%A8%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88"><span class="nav-number">1.</span> <span class="nav-text">雷池Safeline&amp;HFish主动防御方案</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%B7%E6%B1%A0Safeline%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">雷池Safeline简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%9B%B7%E6%B1%A0Safeline%EF%BC%9A"><span class="nav-number">1.2.</span> <span class="nav-text">安装雷池Safeline：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E6%A3%80%E6%B5%8B%EF%BC%9A"><span class="nav-number">1.2.1.</span> <span class="nav-text">环境检测：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.2.2.</span> <span class="nav-text">在线安装（推荐）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85"><span class="nav-number">1.2.3.</span> <span class="nav-text">离线安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.4.</span> <span class="nav-text">安装问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">在线安装失败</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E6%97%B6%E9%81%87%E5%88%B0%E6%8A%A5%E9%94%99%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">安装时遇到报错处理方法：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9AERROR-Cannot-connect-to-the-Docker-daemon-at-unix-var-run-docker-sock-Is-the-docker-daemon-running"><span class="nav-number">1.2.4.2.1.</span> <span class="nav-text">* 报错：ERROR: Cannot connect to the Docker daemon at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock. Is the docker daemon running?</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9Adocker-not-found-unable-to-deploy"><span class="nav-number">1.2.4.2.2.</span> <span class="nav-text">* 报错：docker not found, unable to deploy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9Adocker-compose-v2-not-found-unable-to-deploy"><span class="nav-number">1.2.4.2.3.</span> <span class="nav-text">* 报错：docker compose v2 not found, unable to deploy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9A-failed-to-create-network-safeline-ce"><span class="nav-number">1.2.4.2.4.</span> <span class="nav-text">* 报错： failed to create network safeline-ce</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9A-safeline-tengine-%E5%87%BA%E7%8E%B0-Address-already-in-use"><span class="nav-number">1.2.4.2.5.</span> <span class="nav-text">* 报错： safeline-tengine 出现 Address already in use</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9Asafelint-mgt-api-%E5%87%BA%E7%8E%B0-Operation-not-permitted"><span class="nav-number">1.2.4.2.6.</span> <span class="nav-text">* 报错：safelint-mgt-api 出现 Operation not permitted</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%EF%BC%9Asafeline-pg-%E5%87%BA%E7%8E%B0-Operation-not-permitted"><span class="nav-number">1.2.4.2.7.</span> <span class="nav-text">* 报错：safeline-pg 出现 Operation not permitted</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%A5%87%E6%80%AA%E7%9A%84%E6%8A%A5%E9%94%99%E6%AF%94%E5%A6%82%EF%BC%9AIt-does-not-belong-to-any-of-this-network%E2%80%99s-subnets%E2%80%A6%E7%AD%89%E7%AD%89"><span class="nav-number">1.2.4.2.8.</span> <span class="nav-text">* 其他奇怪的报错比如：It does not belong to any of this network’s subnets…等等</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89-SafeLine-%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%EF%BC%9F"><span class="nav-number">1.2.4.2.9.</span> <span class="nav-text">* 如何自定义 SafeLine 安装路径？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%B7%E6%B1%A0%E5%92%8C%E4%B8%9A%E5%8A%A1%E6%9C%8D%E5%8A%A1%E5%8F%AF%E4%BB%A5%E9%83%A8%E7%BD%B2%E5%88%B0%E5%90%8C%E4%B8%80%E5%8F%B0%E6%9C%BA%E5%99%A8%E4%B8%AD%E5%90%97%EF%BC%9F"><span class="nav-number">1.2.4.2.10.</span> <span class="nav-text">* 雷池和业务服务可以部署到同一台机器中吗？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MacOS-Windows-%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E5%AE%89%E8%A3%85%E9%9B%B7%E6%B1%A0"><span class="nav-number">1.2.4.2.11.</span> <span class="nav-text">* MacOS&#x2F;Windows 是否支持安装雷池</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#docker-compose-%E8%BF%98%E6%98%AF-docker-compose%EF%BC%9F"><span class="nav-number">1.2.4.2.12.</span> <span class="nav-text">* docker compose 还是 docker-compose？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9-SafeLine-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%9A%84%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3%EF%BC%9F%E6%AF%94%E5%A6%82%EF%BC%9A%E6%9C%AC%E6%9C%BA-%E2%80%9C-9443%E2%80%9D%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%88%AB%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%8D%A0%E7%94%A8"><span class="nav-number">1.2.4.2.13.</span> <span class="nav-text">* 如何修改 SafeLine 后台管理的默认端口？比如：本机 “:9443”已经被别的服务占用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%8D%B8%E8%BD%BD"><span class="nav-number">1.2.4.2.14.</span> <span class="nav-text">* 如何卸载</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E6%97%A0%E6%B3%95%E8%A7%A3%E5%86%B3"><span class="nav-number">1.2.4.2.15.</span> <span class="nav-text">* 问题无法解决</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HFish%E7%AE%80%E4%BB%8B"><span class="nav-number">1.3.</span> <span class="nav-text">HFish简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85HFish"><span class="nav-number">1.4.</span> <span class="nav-text">安装HFish</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#CentOS-%E6%98%AFHFish%E5%9B%A2%E9%98%9F%E4%B8%BB%E5%8A%9B%E5%BC%80%E5%8F%91%E5%92%8C%E6%B5%8B%E8%AF%95%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%8E%A8%E8%8D%90%E9%80%89%E7%94%A8CentOS%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E7%AE%A1%E7%90%86%E7%AB%AF"><span class="nav-number">1.4.0.0.1.</span> <span class="nav-text">CentOS 是HFish团队主力开发和测试系统，推荐选用CentOS系统部署管理端</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A5root%E6%9D%83%E9%99%90%E8%BF%90%E8%A1%8C%E4%BB%A5%E4%B8%8B%E5%91%BD%E4%BB%A4%EF%BC%8C%E7%A1%AE%E4%BF%9D%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99%E5%BC%80%E5%90%AFTCP-4433%E3%80%81TCP-4434"><span class="nav-number">1.4.0.0.2.</span> <span class="nav-text">以root权限运行以下命令，确保配置防火墙开启TCP&#x2F;4433、TCP&#x2F;4434</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A5root%E6%9D%83%E9%99%90%E8%BF%90%E8%A1%8C%E4%BB%A5%E4%B8%8B%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E5%91%BD%E4%BB%A4"><span class="nav-number">1.4.0.0.3.</span> <span class="nav-text">以root权限运行以下一键部署命令</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%8C%E6%88%90%E5%AE%89%E8%A3%85%E5%90%8E%EF%BC%8C%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E7%BD%91%E5%9D%80%E3%80%81%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95"><span class="nav-number">1.4.0.0.4.</span> <span class="nav-text">完成安装后，通过以下网址、账号密码登录</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%89%E6%8B%A9"><span class="nav-number">1.4.0.1.</span> <span class="nav-text">数据库选择</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E4%BA%8ESQLite"><span class="nav-number">1.4.0.1.1.</span> <span class="nav-text">关于SQLite</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SQLite%E6%9B%B4%E6%8D%A2%E4%B8%BAMySQL-MariaDB%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.4.0.1.2.</span> <span class="nav-text">SQLite更换为MySQL&#x2F;MariaDB数据库</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BB%E5%8A%A8%E8%81%94%E7%BD%91%E8%A6%81%E6%B1%82"><span class="nav-number">1.4.0.2.</span> <span class="nav-text">主动联网要求</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E5%A3%B0%E6%98%8E"><span class="nav-number">1.4.0.2.1.</span> <span class="nav-text">安全声明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HFish%E7%AE%A1%E7%90%86%E7%AB%AF%E4%B8%BB%E5%8A%A8%E8%AE%BF%E9%97%AE%E5%A6%82%E4%B8%8B%E7%BD%91%E7%BB%9C%E5%9F%9F%E5%90%8D"><span class="nav-number">1.4.0.2.2.</span> <span class="nav-text">HFish管理端主动访问如下网络域名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HFish%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%BB%E5%8A%A8%E8%AE%BF%E9%97%AE%E5%A6%82%E4%B8%8B%E7%BD%91%E7%BB%9C%E5%9F%9F%E5%90%8D"><span class="nav-number">1.4.0.2.3.</span> <span class="nav-text">HFish客户端主动访问如下网络域名</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE"><span class="nav-number">1.4.0.3.</span> <span class="nav-text">安全配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AE%A1%E7%90%86%E7%AB%AF%E5%AE%89%E5%85%A8%E8%A6%81%E6%B1%82"><span class="nav-number">1.4.0.3.1.</span> <span class="nav-text">管理端安全要求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E7%AB%AF%E5%AE%89%E5%85%A8%E8%A6%81%E6%B1%82"><span class="nav-number">1.4.0.3.2.</span> <span class="nav-text">节点端安全要求</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%98%E8%AE%B0%E5%AF%86%E7%A0%81"><span class="nav-number">1.4.1.</span> <span class="nav-text">忘记密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BDHFish"><span class="nav-number">1.4.2.</span> <span class="nav-text">卸载HFish</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4Linux%E7%AE%A1%E7%90%86%E7%AB%AF"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">删除Linux管理端</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E7%A8%8B"><span class="nav-number">1.4.2.1.1.</span> <span class="nav-text">删除计划任务进程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%93%E6%9D%9F%E7%AE%A1%E7%90%86%E7%AB%AF%E8%BF%9B%E7%A8%8B"><span class="nav-number">1.4.2.1.2.</span> <span class="nav-text">结束管理端进程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">1.4.2.1.3.</span> <span class="nav-text">删除文件夹</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B8%85%E7%90%86%E6%89%80%E6%9C%89%E9%85%8D%E7%BD%AE%EF%BC%88%E5%A6%82%E6%9E%9C%E5%90%8E%E7%BB%AD%E8%BF%98%E8%A6%81%E5%AE%89%E8%A3%85%EF%BC%8C%E5%BB%BA%E8%AE%AE%E4%B8%8D%E8%A6%81%E5%88%A0%E9%99%A4%EF%BC%8C%E5%90%A6%E5%88%99%E4%B8%8B%E6%AC%A1%E4%BD%BF%E7%94%A8%E9%9C%80%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E6%96%B0%E9%85%8D%E7%BD%AE%EF%BC%89"><span class="nav-number">1.4.2.1.4.</span> <span class="nav-text">清理所有配置（如果后续还要安装，建议不要删除，否则下次使用需要完全重新配置）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%EF%BC%88SQLite%E5%8F%AF%E5%BF%BD%E7%95%A5%EF%BC%89"><span class="nav-number">1.4.2.1.5.</span> <span class="nav-text">删除MySQL数据库配置（SQLite可忽略）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%98%E5%8E%9FSSH%E5%92%8CFirewall%E9%85%8D%E7%BD%AE"><span class="nav-number">1.4.2.1.6.</span> <span class="nav-text">还原SSH和Firewall配置</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BDLinux%E8%8A%82%E7%82%B9"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">卸载Linux节点</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="nav-number">1.4.2.2.1.</span> <span class="nav-text">删除计划任务</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%93%E6%9D%9Fclient%E8%BF%9B%E7%A8%8B"><span class="nav-number">1.4.2.2.2.</span> <span class="nav-text">结束client进程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4client%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">1.4.2.2.3.</span> <span class="nav-text">删除client文件夹</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#E-R%E6%A8%A1%E5%9E%8B%EF%BC%9A"><span class="nav-number">1.5.</span> <span class="nav-text">E-R模型：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%98%B2%E5%BE%A1%E6%95%88%E6%9E%9C%EF%BC%9A"><span class="nav-number">1.6.</span> <span class="nav-text">防御效果：</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Melt_Tscci"
      src="/avatar.gif">
  <p class="site-author-name" itemprop="name">Melt_Tscci</p>
  <div class="site-description" itemprop="description"> 霜序廿九 | No.R155 </div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/tscci" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tscci" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:i@ceobe.cn" title="E-Mail → mailto:i@ceobe.cn" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://hub.docker.com/u/tscci" title="Docker → https:&#x2F;&#x2F;hub.docker.com&#x2F;u&#x2F;tscci" rel="noopener me" target="_blank"><i class="fa-brands fa-docker fa-fw"></i>Docker</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<div class="cc-license animated" title="TrustAsia 安全签章" id="myssl_seal" onclick="window.open('https://seal.trustasia.com/seal/detail?domain=blog.ceobe.cn','TrustAsia 安全签章','height=800,width=470,top=0,right=0,toolbar=no,menubar=no,scrollbars=no,resizable=no,location=no,status=no')" style="text-align: center">
  <img src="https://sealres.trustasia.com/seal/img/1x/seal.svg?domain=blog.ceobe.cn" alt="TrustAsia 安全签章" style="width: 130px;height: auto;cursor: pointer">
</div>

<div class="cc-license animated" style="text-align: center;" >
<a style="display:inline-block" href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="开往-友链接力">
    <img src="https://www.travellings.cn/assets/logo.gif" alt="开往-友链接力" width="120" height="32" style="border-radius:5px">
</a>
<a style="display:inline-block" href="https://www.foreverblog.cn/go.html" target="_blank"> <img src="https://img.foreverblog.cn/wormhole_3.gif" alt="" style="width:auto;height:32px;border-radius:5px" title="穿梭虫洞-随机访问十年之约友链博客"></a>
</div>
        </div>
      </div>
    </div>

    
   
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-chain fa-fw"></i>
          链接
        </div>
        
          <div class="links-of-author-item" style="display:inline;vertical-align:middle;">
            <a target="_blank" rel="noopener" href="https://monitor.ceobe.cn/status/main" style="color:rgb(221,100,44);display:inline-block;width:130px;"><i class="fa-solid fa-list"></i> 站点监控</a></span>
            <a target="_blank" rel="noopener" href="https://plausible.ceobe.cn/blog.ceobe.cn" style="color:rgb(221,100,44); display: inline-block;width:130px"><i class="fa-solid fa-ranking-star"></i> 访问流量</a>
            <a target="_blank" rel="noopener" href="https://grafana.ceobe.cn/public-dashboards/ff69dff016024859a54c2b7494768cf6?orgId=1&refresh=5s" style="color:rgb(221,100,44); display: inline-block;width:130px;"><i class="fa fa-bar-chart"></i> 性能观测</a>
            <a target="_blank" rel="noopener" href="https://zfile.ceobe.cn/1" style="color:rgb(221,100,44); display: inline-block;width:130px;"><i class="fa-regular fa-folder-open"></i> 网盘文件</a>
            </div>

      </div>
    </div>

    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title">
          <i class="fa-solid fa-wrench fa-fw"></i> 技术支持
        </div>    
        <div class="links-of-author-item" style="display:inline;vertical-align:middle;">
              <a target="_blank" rel="noopener" href="https://www.aliyun.com/product/oss?source=5176.11533457&userCode=s7sc8v2r" style="display: inline-block;width:130px"><i class="fa-solid fa-database"></i> 对象存储</a>
              <a target="_blank" rel="noopener" href="https://www.aliyun.com/product/cdn?source=5176.11533457&userCode=s7sc8v2r" style="display: inline-block;width:130px"><i class="fa-solid fa-earth-americas"></i> CDN加速</a>
        </div>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.ceobe.cn/hfish-safeline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.gif">
      <meta itemprop="name" content="Melt_Tscci">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ceobe's Fungimist">
      <meta itemprop="description" content=" 霜序廿九 | No.R155 ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="雷池Safeline&HFish主动防御方案 | Ceobe's Fungimist">
      <meta itemprop="description" content="雷池Safeline是一个基于智能语义分析引擎的下一代Web应用防火墙（WAF）。HFish是一款社区型免费蜜罐，侧重企业安全场景，从内网失陷检测、外网威胁感知、威胁情报生产三个场景出发，为用户提供可独立操作且实用的功能，通过安全、敏捷、可靠的中低交互蜜罐增加用户在失陷感知和威胁情报领域的能力。本篇将通过结合WAF与蜜罐实现对互联网攻击的主动防范。">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          雷池Safeline&HFish主动防御方案
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-02-01 15:23:36 / 修改时间：15:23:10" itemprop="dateCreated datePublished" datetime="2024-02-01T15:23:36+08:00">2024-02-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E5%85%B3/" itemprop="url" rel="index"><span itemprop="name">网关</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E5%85%B3/Web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99/" itemprop="url" rel="index"><span itemprop="name">Web应用防火墙</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/hfish-safeline/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/hfish-safeline/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>21 分钟</span>
    </span>
</div>

            <div class="post-description">雷池Safeline是一个基于智能语义分析引擎的下一代Web应用防火墙（WAF）。HFish是一款社区型免费蜜罐，侧重企业安全场景，从内网失陷检测、外网威胁感知、威胁情报生产三个场景出发，为用户提供可独立操作且实用的功能，通过安全、敏捷、可靠的中低交互蜜罐增加用户在失陷感知和威胁情报领域的能力。本篇将通过结合WAF与蜜罐实现对互联网攻击的主动防范。</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="雷池Safeline-HFish主动防御方案"><a href="#雷池Safeline-HFish主动防御方案" class="headerlink" title="雷池Safeline&amp;HFish主动防御方案"></a>雷池Safeline&amp;HFish主动防御方案</h1><h2 id="雷池Safeline简介"><a href="#雷池Safeline简介" class="headerlink" title="雷池Safeline简介"></a>雷池Safeline简介</h2><p>雷池Safeline是一个基于智能语义分析引擎的下一代Web应用防火墙（WAF）。由长亭科技开发，雷池Safeline旨在通过其创新的智能语义分析算法，提供对Web应用攻击的深度检测和防护，特别是在面对未知威胁和0day攻击时，显示出天然的优势和防护能力。<br>雷池Safeline的核心优势在于其语义分析技术，这种技术能够理解Web应用上下文中的数据含义，而不仅仅是单纯的字符串匹配。这样的分析能力使得雷池Safeline在检测和阻止恶意流量和攻击行为时更加精准和高效。它能够对Web应用的通信进行深度解析，从而识别并阻断那些使用传统规则防护无法应对的复杂攻击。<br>除了智能语义分析外，雷池Safeline还具备以下特点：</p>
<ul>
<li>高度可扩展性：雷池Safeline设计灵活，能够适应不断变化的网络威胁环境，可以通过更新和迭代不断强化其防护能力。</li>
<li>易用性：雷池Safeline提供简单易用的管理界面，使得配置和部署变得更加直观和简单。</li>
<li>性能优化：雷池Safeline考虑到性能对Web应用的重要性，因此在设计上优化了处理速度和资源消耗，确保在提供强大防护的同时，不会对Web应用的性能造成负面影响。</li>
<li>社区支持：雷池Safeline有一个活跃的社区，用户可以在这里获得技术支持、分享经验以及参与产品的未来发展。<br>雷池Safeline在安全行业获得了一定的认可，其商业版本受到了众多头部企业的信赖，而社区版则通过GitHub平台免费提供，使得更广泛的用户能够零成本体验其智能语义分析算法的能力。雷池Safeline的发布，体现了长亭科技在网络安全领域的创新精神和对开放合作的承诺。</li>
</ul>
<p><img data-src="/hfish-safeline/image-20240201150146817.png" alt="image-20240201150146817"></p>
<h2 id="安装雷池Safeline："><a href="#安装雷池Safeline：" class="headerlink" title="安装雷池Safeline："></a>安装雷池Safeline：</h2><h3 id="环境检测："><a href="#环境检测：" class="headerlink" title="环境检测："></a>环境检测：</h3><p>最低配置需求</p>
<ul>
<li>操作系统：Linux</li>
<li>指令架构：x86_64</li>
<li>软件依赖：Docker 20.10.14 版本以上</li>
<li>软件依赖：Docker Compose 2.0.0 版本以上</li>
<li>最小化环境：1 核 CPU &#x2F; 1 GB 内存 &#x2F; 5 GB 磁盘</li>
</ul>
<p>可以逐行执行以下命令来确认服务器配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uname -m                                    # 查看指令架构</span><br><span class="line">docker version                              # 查看 Docker 版本</span><br><span class="line">docker compose version                      # 查看 Docker Compose 版本</span><br><span class="line">docker-compose version                      # 老版本查看Compose 版本</span><br><span class="line">cat /proc/cpuinfo| grep &quot;processor&quot;         # 查看 CPU 信息</span><br><span class="line">free -h                                     # 查看内存信息</span><br><span class="line">df -h                                       # 查看磁盘信息</span><br><span class="line">lscpu | grep ssse3                          # 确认CPU是否支持 ssse3 指令集</span><br></pre></td></tr></table></figure>

<h3 id="在线安装（推荐）"><a href="#在线安装（推荐）" class="headerlink" title="在线安装（推荐）"></a>在线安装（推荐）</h3><p>复制以下命令执行，即可完成安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &quot;$(curl -fsSLk https://waf-ce.chaitin.cn/release/latest/setup.sh)&quot; </span><br></pre></td></tr></table></figure>

<p>如果需要使用华为云加速，可使用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CDN=1 bash -c &quot;$(curl -fsSLk https://waf-ce.chaitin.cn/release/latest/setup.sh)&quot; </span><br></pre></td></tr></table></figure>

<p>如果需要安装最新版本流式检测模式，可使用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">STREAM=1 bash -c &quot;$(curl -fsSLk https://waf-ce.chaitin.cn/release/latest/setup.sh)&quot; </span><br></pre></td></tr></table></figure>

<ul>
<li>若安装失败，请参考 <a href="#%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98">安装问题</a></li>
</ul>
<h3 id="离线安装"><a href="#离线安装" class="headerlink" title="离线安装"></a>离线安装</h3><ul>
<li>如果服务器不可以访问互联网环境，推荐使用该方式</li>
</ul>
<ol>
<li>下载 <a target="_blank" rel="noopener" href="https://demo.waf-ce.chaitin.cn/image.tar.gz">雷池社区版镜像包</a> 并传输到需要安装雷池的服务器上，执行以下命令加载镜像</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat image.tar.gz | gzip -d | docker load</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>执行以下命令创建并进入雷池安装目录</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p safeline  &amp;&amp;  <span class="built_in">cd</span> safeline    <span class="comment"># 创建 safeline 目录并且进入</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>下载 <a target="_blank" rel="noopener" href="https://waf-ce.chaitin.cn/release/latest/compose.yaml">编排脚本</a> 并传输到 safeline 目录中</p>
</li>
<li><p>复制执行以下命令，生成雷池运行所需的相关环境变量</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt; .env &lt;&lt;EOF</span><br><span class="line">SAFELINE_DIR=$(pwd)</span><br><span class="line">IMAGE_TAG=latest</span><br><span class="line">MGT_PORT=9443</span><br><span class="line">POSTGRES_PASSWORD=$(LC_ALL=C tr -dc A-Za-z0-9 &lt;/dev/urandom | head -c 32)</span><br><span class="line">SUBNET_PREFIX=172.22.222</span><br><span class="line">IMAGE_PREFIX=chaitin</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<ul>
<li>不要一行一行复制，一次性复制全部命令后执行</li>
</ul>
</li>
<li><p>执行以下命令启动雷池</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<ul>
<li>若安装失败，请参考 <a href="#%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98">安装问题</a></li>
</ul>
</li>
</ol>
<h3 id="安装问题"><a href="#安装问题" class="headerlink" title="安装问题"></a>安装问题</h3><h4 id="在线安装失败"><a href="#在线安装失败" class="headerlink" title="在线安装失败"></a>在线安装失败</h4><ol>
<li>检查是否手动关闭防火墙</li>
<li>检测配置是否符合最低的配置要求</li>
</ol>
<blockquote>
<p>参考 <a href="#%E7%8E%AF%E5%A2%83%E6%A3%80%E6%B5%8B%EF%BC%9A">环境检测</a>方式</p>
</blockquote>
<ol>
<li>如果连接 Docker Hub 网络不稳，导致镜像下载失败（超时）:</li>
</ol>
<blockquote>
<p>docker hub 默认使用国外节点拉取镜像，可以自行搜索配置国内镜像加速源</p>
</blockquote>
<blockquote>
<p>采用 <a href="#%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85">离线安装</a> 方式</p>
</blockquote>
<h4 id="安装时遇到报错处理方法："><a href="#安装时遇到报错处理方法：" class="headerlink" title="安装时遇到报错处理方法："></a>安装时遇到报错处理方法：</h4><h5 id="报错：ERROR-Cannot-connect-to-the-Docker-daemon-at-unix-var-run-docker-sock-Is-the-docker-daemon-running"><a href="#报错：ERROR-Cannot-connect-to-the-Docker-daemon-at-unix-var-run-docker-sock-Is-the-docker-daemon-running" class="headerlink" title="* 报错：ERROR: Cannot connect to the Docker daemon at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock. Is the docker daemon running?"></a>* 报错：ERROR: Cannot connect to the Docker daemon at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock. Is the docker daemon running?</h5><p>需要安装 docker。尝试 <code>curl -fLsS https://get.docker.com/ | sh</code> 或者<a href="/dockerinit/" title="Docker初始化环境">Docker初始化环境</a>。</p>
<h5 id="报错：docker-not-found-unable-to-deploy"><a href="#报错：docker-not-found-unable-to-deploy" class="headerlink" title="* 报错：docker not found, unable to deploy"></a>* 报错：docker not found, unable to deploy</h5><p>failed to create network safeline-ce safeline-ce 是雷池部署时候创建的 network，出现类似报错，先重启下 dockerd 之后重试</p>
<p>需要启动 docker daemon 才能执行相关的命令。尝试 <code>systemctl start docker</code>。</p>
<h5 id="报错：docker-compose-v2-not-found-unable-to-deploy"><a href="#报错：docker-compose-v2-not-found-unable-to-deploy" class="headerlink" title="* 报错：docker compose v2 not found, unable to deploy"></a>* 报错：docker compose v2 not found, unable to deploy</h5><p>需要安装 docker compose v2。尝试 <a href="/dockerinit/" title="Docker初始化环境">Docker初始化环境</a>。</p>
<h5 id="报错：-failed-to-create-network-safeline-ce"><a href="#报错：-failed-to-create-network-safeline-ce" class="headerlink" title="* 报错： failed to create network safeline-ce"></a>* 报错： failed to create network safeline-ce</h5><p>safeline-ce 是雷池部署时候创建的 network，出现类似报错，先重启下 dockerd 之后重试。</p>
<h5 id="报错：-safeline-tengine-出现-Address-already-in-use"><a href="#报错：-safeline-tengine-出现-Address-already-in-use" class="headerlink" title="* 报错： safeline-tengine 出现 Address already in use"></a>* 报错： safeline-tengine 出现 Address already in use</h5><p><code>docker logs -f safeline-tengine</code> 容器日志中看到 “Address already in use”信息。</p>
<p>端口冲突，根据报错信息中的端口号，排查是哪个服务占用了，手动处理冲突。</p>
<h5 id="报错：safelint-mgt-api-出现-Operation-not-permitted"><a href="#报错：safelint-mgt-api-出现-Operation-not-permitted" class="headerlink" title="* 报错：safelint-mgt-api 出现 Operation not permitted"></a>* 报错：safelint-mgt-api 出现 Operation not permitted</h5><p><code>docker logs -f safelint-mgt-api</code> 容器日志中看到 “runtime&#x2F;cgo: pthread_create failed: Operation not permitted” 报错，这个错误一般会在 docker 20.10.9 及以下发生。</p>
<ul>
<li><p>最推荐的方式是升级 docker 到最新版本尝试解决这个问题。</p>
</li>
<li><p>或您的系统支持配置 seccomp （执行 <code>grep CONFIG_SECCOMP= /boot/config-$(uname -r)</code> 输出 “ CONFIG_SECCOMP&#x3D;y ” 则为支持）, 则可以在雷池工作目录下载 <a target="_blank" rel="noopener" href="https://waf-ce.chaitin.cn/release/latest/seccomp.json">seccomp</a> 并且编辑 compose.yaml 文件， 在 management 下加入如下配置项，然后执行 <code>docker compose down &amp;&amp; docker compose up -d</code> 来尝试解决这个问题:</p>
<figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">security_opt</span><span class="punctuation">:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">seccomp=./seccomp.json</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="报错：safeline-pg-出现-Operation-not-permitted"><a href="#报错：safeline-pg-出现-Operation-not-permitted" class="headerlink" title="* 报错：safeline-pg 出现 Operation not permitted"></a>* 报错：safeline-pg 出现 Operation not permitted</h5><p><code>docker logs -f safeline-pg</code> 容器日志中看到 “Operation not permitted” 报错。</p>
<p>可能是您的 docker 版本过低，升级 docker 到最新版本尝试一下。</p>
<h5 id="其他奇怪的报错比如：It-does-not-belong-to-any-of-this-network’s-subnets…等等"><a href="#其他奇怪的报错比如：It-does-not-belong-to-any-of-this-network’s-subnets…等等" class="headerlink" title="* 其他奇怪的报错比如：It does not belong to any of this network’s subnets…等等"></a>* 其他奇怪的报错比如：It does not belong to any of this network’s subnets…等等</h5><p>查看<a href="#%E5%A6%82%E4%BD%95%E5%8D%B8%E8%BD%BD">如何卸载</a> ，卸载以后重新安装一次</p>
<h5 id="如何自定义-SafeLine-安装路径？"><a href="#如何自定义-SafeLine-安装路径？" class="headerlink" title="* 如何自定义 SafeLine 安装路径？"></a>* 如何自定义 SafeLine 安装路径？</h5><p>基于最新的 “compose.yaml”，你可以手动修改 “.env” 文件的 <SAFELINE_DIR> 变量。</p>
<h5 id="雷池和业务服务可以部署到同一台机器中吗？"><a href="#雷池和业务服务可以部署到同一台机器中吗？" class="headerlink" title="* 雷池和业务服务可以部署到同一台机器中吗？"></a>* 雷池和业务服务可以部署到同一台机器中吗？</h5><p>可以，但是不建议，机器负载将高于分开部署。</p>
<h5 id="MacOS-Windows-是否支持安装雷池"><a href="#MacOS-Windows-是否支持安装雷池" class="headerlink" title="* MacOS&#x2F;Windows 是否支持安装雷池"></a>* MacOS&#x2F;Windows 是否支持安装雷池</h5><p>社区版暂不支持，如有需求咨询企业版。</p>
<h5 id="docker-compose-还是-docker-compose？"><a href="#docker-compose-还是-docker-compose？" class="headerlink" title="* docker compose 还是 docker-compose？"></a>* docker compose 还是 docker-compose？</h5><p>属于两个版本，推荐使用 docker compose</p>
<h5 id="如何修改-SafeLine-后台管理的默认端口？比如：本机-“-9443”已经被别的服务占用"><a href="#如何修改-SafeLine-后台管理的默认端口？比如：本机-“-9443”已经被别的服务占用" class="headerlink" title="* 如何修改 SafeLine 后台管理的默认端口？比如：本机 “:9443”已经被别的服务占用"></a>* 如何修改 SafeLine 后台管理的默认端口？比如：本机 “:9443”已经被别的服务占用</h5><p>使用 <code>ss -antp|grep LISTEN</code> 确认端口使用情况，找到未被占用端口</p>
<p>修改在安装目录(默认 safeline)下的隐藏文件<code>.env</code> 文件，你可以手动添加 <code>MGT_PORT</code> 变量到 <code>.env</code> 文件。</p>
<p>文件修改后，需要等重启才会生效。</p>
<p>在安装目录(默认 safeline)下执行 <code>docker compose down &amp;&amp; docker compose up -d</code></p>
<h5 id="如何卸载"><a href="#如何卸载" class="headerlink" title="* 如何卸载"></a>* 如何卸载</h5><p>在安装目录(默认 safeline)下</p>
<p>根据本地的compose版本，执行 <code>docker compose down</code> 或者 <code>docker-compose down</code></p>
<h5 id="问题无法解决"><a href="#问题无法解决" class="headerlink" title="* 问题无法解决"></a>* 问题无法解决</h5><ol>
<li>通过右上角搜索检索其他页面</li>
<li>通过社群（官网首页加入微信讨论组）寻求帮助或者 Github issue 提交反馈，并附上排查的过程和截图</li>
</ol>
<h2 id="HFish简介"><a href="#HFish简介" class="headerlink" title="HFish简介"></a>HFish简介</h2><p>HFish是一款社区型免费蜜罐，侧重企业安全场景，从内网失陷检测、外网威胁感知、威胁情报生产三个场景出发，为用户提供可独立操作且实用的功能，通过安全、敏捷、可靠的中低交互蜜罐增加用户在失陷感知和威胁情报领域的能力。</p>
<p>HFish支持基本网络 服务、OA系统、CRM系统、NAS存储系统、Web服务器、运维平台、安全产品、无线AP、交换机&#x2F;路由器、邮件系统、IoT设备等90多种蜜罐服务、支持用户制作自定义Web蜜罐、支持流量牵引到免费云蜜网、支持可开关的全端口扫描感知能力、支持可自定义的蜜饵配置、一键部署、跨平台多架构，支持Linux x32&#x2F;x64&#x2F;ARM、Windows x32&#x2F;x64平台和多种国产操作系统、支持龙芯、海光、飞腾、鲲鹏、腾云、兆芯等国产CPU、极低的性能要求、邮件&#x2F;syslog&#x2F;webhook&#x2F;企业微信&#x2F;钉钉&#x2F;飞书告警等多项特性，帮助用户降低运维成本，提升运营效率。</p>
<p><img data-src="/hfish-safeline/image-20240201150100393.png" alt="image-20240201150100393"></p>
<h2 id="安装HFish"><a href="#安装HFish" class="headerlink" title="安装HFish"></a>安装HFish</h2><blockquote>
<h5 id="CentOS-是HFish团队主力开发和测试系统，推荐选用CentOS系统部署管理端"><a href="#CentOS-是HFish团队主力开发和测试系统，推荐选用CentOS系统部署管理端" class="headerlink" title="CentOS 是HFish团队主力开发和测试系统，推荐选用CentOS系统部署管理端"></a>CentOS 是HFish团队主力开发和测试系统，推荐选用CentOS系统部署管理端</h5></blockquote>
<p>​	如果部署的环境为Linux，且可以访问互联网，强烈建议使用一键部署脚本进行安装和配置，在使用一键脚本前，请先配置防火墙。</p>
<p>​	蜜罐节点暴露在互联网，可能会出现TCP连接超过最大1024个连接数限制，导致其他连接被拒绝的情况，可手动放开机器TCP最大连接数。</p>
<ul>
<li><p>第一步，修改&#x2F;etc&#x2F;security&#x2F;limits.conf文件，在文件中添加如下行(*指代系统用户名)，修改Linux系统对用户的关于打开文件数的软限制和硬限制：</p>
</li>
<li><pre><code>soft nofile 65535
hard nofile 65535
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 第二步，修改/etc/pam.d/login文件，在文件中添加如下行：</span><br><span class="line"></span><br><span class="line">　　　　session required /lib/security/pam_limits<span class="selector-class">.so</span></span><br><span class="line"></span><br><span class="line">　　　　如果是<span class="number">64</span>bit系统的话，应该为 :</span><br><span class="line">　　　　session required /lib64/security/pam_limits<span class="selector-class">.so</span></span><br><span class="line"></span><br><span class="line">- 第三步，修改/etc/sysctl.conf文件，在文件中(清楚文件原始内容)添加如下行（修改网络内核对TCP连接的有关限制）：</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.ip_local_port_range</span> = <span class="number">1024</span> <span class="number">65535</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.core</span>.rmem_max=<span class="number">16777216</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.core</span>.wmem_max=<span class="number">16777216</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span>.tcp_rmem=<span class="number">4096</span> <span class="number">87380</span> <span class="number">16777216</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span>.tcp_wmem=<span class="number">4096</span> <span class="number">65536</span> <span class="number">16777216</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_fin_timeout</span> = <span class="number">10</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_tw_recycle</span> = <span class="number">1</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_timestamps</span> = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_window_scaling</span> = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_sack</span> = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.core</span><span class="selector-class">.netdev_max_backlog</span> = <span class="number">30000</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span>.tcp_no_metrics_save=<span class="number">1</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.core</span><span class="selector-class">.somaxconn</span> = <span class="number">262144</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_syncookies</span> = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_max_orphans</span> = <span class="number">262144</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_max_syn_backlog</span> = <span class="number">262144</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_synack_retries</span> = <span class="number">2</span></span><br><span class="line">  </span><br><span class="line">  net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_syn_retries</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>第四步，执行如下命令（使上述设置生效）：</p>
</li>
<li><pre><code>/sbin/sysctl -p /etc/sysctl.conf

/sbin/sysctl -w net.ipv4.route.flush=1
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 第五步，执行如下命令（linux系统优化完网络必须调高系统允许打开的文件数才能支持大的并发，默认1024是远远不够的）：</span><br><span class="line"></span><br><span class="line">- ```shell</span><br><span class="line">  <span class="built_in">echo</span> <span class="built_in">ulimit</span> -HSn 65536 &gt;&gt; /etc/rc.local</span><br><span class="line">  </span><br><span class="line">  　<span class="built_in">echo</span> <span class="built_in">ulimit</span> -HSn 65536 &gt;&gt;/root/.bash_profile</span><br><span class="line">  </span><br><span class="line">  　<span class="built_in">ulimit</span> -HSn 65536</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>第六步，重启机器。通过修改，tcp可以达到20000个连接完全没有问题。</p>
</li>
</ul>
<h5 id="以root权限运行以下命令，确保配置防火墙开启TCP-4433、TCP-4434"><a href="#以root权限运行以下命令，确保配置防火墙开启TCP-4433、TCP-4434" class="headerlink" title="以root权限运行以下命令，确保配置防火墙开启TCP&#x2F;4433、TCP&#x2F;4434"></a>以root权限运行以下命令，确保配置防火墙开启TCP&#x2F;4433、TCP&#x2F;4434</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --add-port=4433/tcp --permanent   #（用于web界面启动）</span><br><span class="line">firewall-cmd --add-port=4434/tcp --permanent   #（用于节点与管理端通信）</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<p>如之后蜜罐服务需要占用其他端口，可使用相同命令打开</p>
<h5 id="以root权限运行以下一键部署命令"><a href="#以root权限运行以下一键部署命令" class="headerlink" title="以root权限运行以下一键部署命令"></a>以root权限运行以下一键部署命令</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sS -L https://hfish.net/webinstall.sh)</span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="完成安装后，通过以下网址、账号密码登录"><a href="#完成安装后，通过以下网址、账号密码登录" class="headerlink" title="完成安装后，通过以下网址、账号密码登录"></a>完成安装后，通过以下网址、账号密码登录</h5></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">登陆链接：https://[ip]:4433/web/</span><br><span class="line">账号：admin</span><br><span class="line">密码：HFish2021复制失败成功</span><br></pre></td></tr></table></figure>

<p>如果管理端的IP是192.168.1.1，则登陆链接为：<a target="_blank" rel="noopener" href="https://192.168.1.1:4433/web/">https://192.168.1.1:4433/web/</a></p>
<ul>
<li>URL中&#x2F;web&#x2F;路径不能少</li>
</ul>
<h4 id="数据库选择"><a href="#数据库选择" class="headerlink" title="数据库选择"></a>数据库选择</h4><p>除非性能极度紧张或环境所限，否则<strong>强烈建议使用MySQL&#x2F;MariaDB数据库</strong>。</p>
<p>经过实战测评，MySQL&#x2F;MariaDB数据库可以适应目前绝大多数场景，其数据处理和并发兼容能力都要优于SQLite。</p>
<blockquote>
<h5 id="关于SQLite"><a href="#关于SQLite" class="headerlink" title="关于SQLite"></a>关于SQLite</h5></blockquote>
<p>出于开箱即用考虑，HFish系统默认使用的SQLite数据库，自带的已经初始化好的db具体路径为&#x2F;usr&#x2F;share&#x2F;db&#x2F;hfish.db</p>
<p>SQLite数据库仅适用于功能预览、小规模内网环境失陷感知等有限场景。</p>
<blockquote>
<h5 id="SQLite更换为MySQL-MariaDB数据库"><a href="#SQLite更换为MySQL-MariaDB数据库" class="headerlink" title="SQLite更换为MySQL&#x2F;MariaDB数据库"></a>SQLite更换为MySQL&#x2F;MariaDB数据库</h5></blockquote>
<p>HFish提供两种更换数据库的机会：</p>
<p>1、在首次安装时，用户可以选择使用SQLite或MySQL&#x2F;MariaDB数据库</p>
<p>2、如果已经选择了SQLite，以管理员身份登录后，在「数据库配置」页面，根据指南可快速更换数据库</p>
<ul>
<li>HFish只支持SQLite向MySQL&#x2F;MariaDB数据库迁移，不支持反向迁移。</li>
</ul>
<h4 id="主动联网要求"><a href="#主动联网要求" class="headerlink" title="主动联网要求"></a>主动联网要求</h4><blockquote>
<h5 id="安全声明"><a href="#安全声明" class="headerlink" title="安全声明"></a>安全声明</h5></blockquote>
<p>HFish使用100% Golang语言开发，本地采用低交互蜜罐，本地模拟的所有网络服务都是由HFish构架的虚假服务，攻击者看似可以登录进入MySQL、Redis等蜜罐服务，但实际上那是完全用Golang开发的MySQL、Redis部分能力，用于迷惑攻击者。用户完全不需要担心HFish模拟服务被击穿的风险。</p>
<blockquote>
<h5 id="HFish管理端主动访问如下网络域名"><a href="#HFish管理端主动访问如下网络域名" class="headerlink" title="HFish管理端主动访问如下网络域名"></a>HFish管理端主动访问如下网络域名</h5></blockquote>
<p>HFish支持IPv4和IPv6网络环境，可以在完全隔离互联网的内部网络工作，但为了最大限度感知真实威胁、对接云端高交互情报、对接消费云端威胁情报和自动化升级，强烈建议客户允许HFish管理端主动访问有限互联网地址，管理端<strong>永远不会</strong>主动访问节点，管理端仅负责生成一个配置，等待节点每60秒尝试连接管理端拉取。</p>
<p>为兼顾安全性和服务可用性，建议用户设置ACL仅允许HFish管理端主动访问如下网络域名、地址和端口：</p>
<table>
<thead>
<tr>
<th>开放IP</th>
<th>对应开放域名</th>
<th>协议&#x2F;端口</th>
<th>访问目的</th>
</tr>
</thead>
<tbody><tr>
<td>106.75.31.212、106.75.71.108</td>
<td>api.hfish.net（已经禁止ping）</td>
<td>TCP&#x2F;443</td>
<td>用于官网升级与攻击数据拉取，建议开启</td>
</tr>
<tr>
<td>106.75.5.50、106.75.15.34</td>
<td>zoo.hfish.net（已经禁止ping）</td>
<td>TCP&#x2F;22222（高交互ssh端口）、TCP&#x2F;22223（高交互Telnet端口)</td>
<td>用于与云端高交互蜜罐通信，建议开启</td>
</tr>
<tr>
<td>43.227.197.203、43.227.197.42</td>
<td>hfish.cn-bj.ufileos.com</td>
<td>TCP&#x2F;443</td>
<td>用于分发安装和升级包</td>
</tr>
<tr>
<td>106.75.36.224、123.59.51.113、123.59.72.253、106.75.36.226</td>
<td>api.threatbook.cn</td>
<td>TCP&#x2F;443</td>
<td>用于威胁情报查询，如果未启用该功能，无需开放</td>
</tr>
<tr>
<td>（无法罗列，建议按域名开通）</td>
<td>open.feishu.cn</td>
<td>TCP&#x2F;443</td>
<td>用于飞书告警功能，如果未使用该功能，无需开放</td>
</tr>
<tr>
<td>（无法罗列，建议按域名开通）</td>
<td>oapi.dingtalk.com</td>
<td>TCP&#x2F;443</td>
<td>用于钉钉告警功能，如果未使用该功能，无需开放</td>
</tr>
<tr>
<td>（无法罗列，建议按域名开通）</td>
<td>qyapi.weixin.qq.com</td>
<td>TCP&#x2F;443</td>
<td>用于企业微信告警功能，如果未使用该功能，无需开放</td>
</tr>
</tbody></table>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">注意：</span><br><span class="line"><span class="bullet">1.</span> 基于安全考虑，不建议用户将HFish管理端Web管理端口TCP/4433暴露在互联网；</span><br><span class="line"><span class="bullet">2.</span> 如果使用邮件通知，请开启相应邮件服务器的访问权限；</span><br><span class="line"><span class="bullet">3.</span> HFish支持最多 5 路syslog日志发送，便于与安全设备联动，请根据实际情况开放权限；复制失败成功</span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="HFish客户端主动访问如下网络域名"><a href="#HFish客户端主动访问如下网络域名" class="headerlink" title="HFish客户端主动访问如下网络域名"></a>HFish客户端主动访问如下网络域名</h5></blockquote>
<p>HFish客户端不会主动访问除管理端外任何地址。</p>
<h4 id="安全配置"><a href="#安全配置" class="headerlink" title="安全配置"></a>安全配置</h4><blockquote>
<h5 id="管理端安全要求"><a href="#管理端安全要求" class="headerlink" title="管理端安全要求"></a>管理端安全要求</h5></blockquote>
<p>管理端应部署在安全区，只向少部分有网络管理权限和安全分析能力工作的人员和设备开放Web和SSH端口。</p>
<p>管理端用于配置管理的Web页面开启了HTTPS，默认访问端口为TCP&#x2F;4433，虽然官方不推荐，但是用户可以在config.ini中自行修改Web管理端口和登录URL。</p>
<p>此外，管理端还会开放TCP&#x2F;4434用于节点和管理端进行通讯，该端口不可改变，且必须保证该端口可被所有节点联通。</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注意：</span><br><span class="line"><span class="bullet">- </span>TCP/4433端口和TCP/22端口 “只能”被安全区的管理设备访问；</span><br><span class="line"><span class="bullet">- </span>TCP/4434端口“必须能”被蜜罐节点访问;复制失败成功</span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="节点端安全要求"><a href="#节点端安全要求" class="headerlink" title="节点端安全要求"></a>节点端安全要求</h5></blockquote>
<p>蜜罐节点直接面对攻击者，建议遵循以下安全配置：</p>
<ol>
<li>如果用户同时有外网和内部需求，强烈建议用户分别在外网和内网部署完全独立的两套管理端和节点端；</li>
<li>如果有节点需要能被外网访问，建议把节点和管理端部署在DMZ区；</li>
<li>外网节点除了能访问管理端的TCP&#x2F;4434端口外，不能有权限访问内网中的任何资产；</li>
<li>内网节点除了开放蜜罐服务相应端口外，其它任何端口都不应该在网络中能被用户访问到；</li>
<li>考虑安全区设备有维护节点主机的需求，可以向有限的设备开放SSH端口；</li>
</ol>
<h3 id="忘记密码"><a href="#忘记密码" class="headerlink" title="忘记密码"></a>忘记密码</h3><p>如果用户不慎忘记HFish Web管理端admin密码，可以按照如下步骤强行重置。</p>
<ol>
<li>进入HFish管理端安装目录，执行.&#x2F;tools -mode resetpwd</li>
<li>kill hfish-server 等待几秒钟，进程会被自动拉起</li>
<li>使用默认账号密码：admin&#x2F;HFish2021进行登录</li>
</ol>
<h3 id="卸载HFish"><a href="#卸载HFish" class="headerlink" title="卸载HFish"></a>卸载HFish</h3><h4 id="删除Linux管理端"><a href="#删除Linux管理端" class="headerlink" title="删除Linux管理端"></a>删除Linux管理端</h4><blockquote>
<h5 id="删除计划任务进程"><a href="#删除计划任务进程" class="headerlink" title="删除计划任务进程"></a>删除计划任务进程</h5></blockquote>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 打开计划任务，删除带有hfish字样的行</span></span><br><span class="line">root<span class="symbol">@HFish</span>~<span class="meta"># crontab -e复制失败成功</span></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="结束管理端进程"><a href="#结束管理端进程" class="headerlink" title="结束管理端进程"></a>结束管理端进程</h5></blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结束hfish和hfish-server的进程</span></span><br><span class="line"><span class="attribute">root</span>@HFish~# ps ax | grep ./hfish | grep -v grep</span><br><span class="line"><span class="attribute">8435</span> ?        Sl    <span class="number">97</span>:<span class="number">59</span> ./hfish</span><br><span class="line"><span class="attribute">8436</span> ?        Sl    <span class="number">97</span>:<span class="number">59</span> ./hfish-server</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">root</span>@HFish:~# kill -<span class="number">9</span> <span class="number">8435</span></span><br><span class="line"><span class="attribute">root</span>@HFish:~# kill -<span class="number">9</span> <span class="number">8436</span>复制失败成功</span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="删除文件夹"><a href="#删除文件夹" class="headerlink" title="删除文件夹"></a>删除文件夹</h5></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用install.sh安装的HFish会被部署到/opt/hfish目标，将整个删除即可</span></span><br><span class="line"><span class="meta prompt_">root@HFish~# </span><span class="language-bash"><span class="built_in">rm</span> -rf /opt/hfish复制失败成功</span></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="清理所有配置（如果后续还要安装，建议不要删除，否则下次使用需要完全重新配置）"><a href="#清理所有配置（如果后续还要安装，建议不要删除，否则下次使用需要完全重新配置）" class="headerlink" title="清理所有配置（如果后续还要安装，建议不要删除，否则下次使用需要完全重新配置）"></a>清理所有配置（如果后续还要安装，建议不要删除，否则下次使用需要完全重新配置）</h5></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用install.sh安装的HFish会在/usr/share/hfish下建立全局变量</span></span><br><span class="line"><span class="meta prompt_">root@HFish~# </span><span class="language-bash"><span class="built_in">rm</span> -rf /usr/share/hfish复制失败成功</span></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="删除MySQL数据库配置（SQLite可忽略）"><a href="#删除MySQL数据库配置（SQLite可忽略）" class="headerlink" title="删除MySQL数据库配置（SQLite可忽略）"></a>删除MySQL数据库配置（SQLite可忽略）</h5></blockquote>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除HFish数据库</span></span><br><span class="line">root<span class="variable">@HFish</span><span class="symbol">:~</span><span class="comment"># mysql -h127.0.0.1 -uroot -p</span></span><br><span class="line"><span class="title class_">Enter</span> <span class="symbol">password:</span>*******（默认密码详见config.ini配置文件）</span><br><span class="line">mysql&gt; <span class="title class_">DROP</span> <span class="title class_">DATABASE</span> hfish;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止MySQL服务</span></span><br><span class="line">root<span class="variable">@HFish</span><span class="symbol">:~</span><span class="comment"># systemctl stop mysqld</span></span><br><span class="line">root<span class="variable">@HFish</span><span class="symbol">:~</span><span class="comment"># systemctl disable mysqld复制失败成功</span></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="还原SSH和Firewall配置"><a href="#还原SSH和Firewall配置" class="headerlink" title="还原SSH和Firewall配置"></a>还原SSH和Firewall配置</h5></blockquote>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清除SSH config内对于访问来源的限制</span></span><br><span class="line">root@HFish~<span class="comment"># vi /etc/ssh/sshd_config</span></span><br><span class="line">注释掉以 AllowUsers root@ 开头的行</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启SSH服务</span></span><br><span class="line">root@HFish~<span class="comment"># systemctl restart sshd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 清除Firewall服务的规则（请根据实际情况删除！）</span></span><br><span class="line">root@HFish~<span class="comment"># firewall-cmd --permanent --list-all | grep ports | head -n 1 | \</span></span><br><span class="line">cut -d: -f2 | <span class="keyword">tr</span> <span class="string">&#x27; &#x27;</span> <span class="string">&#x27;\n&#x27;</span> | xargs -I &#123;&#125; firewall-cmd --permanent --remove-port=&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启Firewall服务</span></span><br><span class="line">root@HFish~<span class="comment"># systemctl restart firewalld复制失败成功</span></span><br></pre></td></tr></table></figure>

<h4 id="卸载Linux节点"><a href="#卸载Linux节点" class="headerlink" title="卸载Linux节点"></a>卸载Linux节点</h4><blockquote>
<h5 id="删除计划任务"><a href="#删除计划任务" class="headerlink" title="删除计划任务"></a>删除计划任务</h5></blockquote>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 打开计划任务，删除带有hfish字样的行</span></span><br><span class="line">root<span class="symbol">@HFish</span>~<span class="meta"># crontab -e复制失败成功</span></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="结束client进程"><a href="#结束client进程" class="headerlink" title="结束client进程"></a>结束client进程</h5></blockquote>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@HFish</span>~<span class="comment"># ps ax | grep ./client | grep -v grep</span></span><br><span class="line"><span class="number">8435</span> ?        <span class="title class_">Sl</span>    <span class="number">97</span><span class="symbol">:</span><span class="number">59</span> ./client</span><br><span class="line"></span><br><span class="line">root<span class="variable">@HFish</span><span class="symbol">:~</span><span class="comment"># kill -9 8435复制失败成功</span></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="删除client文件夹"><a href="#删除client文件夹" class="headerlink" title="删除client文件夹"></a>删除client文件夹</h5></blockquote>
<p>文件夹路径为按照自己的安装路径，client端没有全局配置，删除安装文件夹即可</p>
<h2 id="E-R模型："><a href="#E-R模型：" class="headerlink" title="E-R模型："></a>E-R模型：</h2><p><img data-src="/hfish-safeline/er.png" alt="er"></p>
<p>​	互联网环境部署，HFish管理端和雷池Safeline位于同一区域内相互隔离的VPC中，HFish节点端位于不同区域VPC。HFish用于配置web蜜罐以及收集互联网威胁情报，调用微步在线威胁分析与情报共享社区的IP信誉接口，将收集到的外网攻击数据存储在RDS云数据库中，数据库定时执行任务，抽取HFish数据库中的IP地址，清洗后存储到高危地址库，服务器定时执行推送任务，将IP地址表发布到托管平台，雷池Safeline自带IP组订阅功能，每天更新高危IP地址，实现web应用黑名单同步更新，主动拦截黑名单地址的web服务请求。</p>
<p><img data-src="/hfish-safeline/image-20240201143147891.png" alt="image-20240201143147891"></p>
<ul>
<li><p>IP地址表同步：</p>
<p>将hfish库的ipaddress表中的ip、国家、威胁等级、标签、更新时间值同步到dataset库的threatips表中，ip地址唯一，威胁等级大于2（中威胁度及以上）。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dataset.threatips (ip, country, threat_level, labels_cn, update_time)</span><br><span class="line"><span class="keyword">SELECT</span> ip, country, threat_level, labels_cn, update_time</span><br><span class="line"><span class="keyword">FROM</span> hfish.ipaddress</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">FROM</span> sync.threatips</span><br><span class="line"><span class="keyword">WHERE</span> threatips.ip <span class="operator">=</span> hfish.ipaddress.ip</span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> hfish.ipaddress.threat_level <span class="operator">&gt;</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>值同步</p>
<p>IP地址同步后，执行值同步任务，更新dataset表中更新时间、标签、威胁等级、国家的值。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> threatips</span><br><span class="line"><span class="keyword">SET</span> <span class="operator">&lt;</span>update_time<span class="operator">&gt;</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">&lt;</span>update_time<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">FROM</span> hfish.ipaddress</span><br><span class="line">    <span class="keyword">WHERE</span> threatips.ip <span class="operator">=</span> ipaddress.ip</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>拉取IP地址</li>
</ul>
<p>​	编写shell脚本定时从数据库拉取IP地址，输出txt文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 编辑数据库信息</span></span><br><span class="line">DB_USER=<span class="string">&quot;username&quot;</span></span><br><span class="line">DB_PASSWORD=<span class="string">&quot;password&quot;</span></span><br><span class="line">DB_NAME=<span class="string">&quot;dataset&quot;</span></span><br><span class="line">TABLE_NAME=<span class="string">&quot;threatips&quot;</span></span><br><span class="line">COLUMN_NAME=<span class="string">&quot;ip&quot;</span></span><br><span class="line">HOST=<span class="string">&quot;dbhost:3306&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标文件夹</span></span><br><span class="line">EXPORT_DIR=<span class="string">&quot;/opt/output&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查目录是否存在</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$EXPORT_DIR</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出文件名&lt;数据表_ip_日期&gt;.txt</span></span><br><span class="line">OUTPUT_FILE=<span class="string">&quot;<span class="variable">$EXPORT_DIR</span>/<span class="variable">$&#123;TABLE_NAME&#125;</span>_<span class="variable">$&#123;COLUMN_NAME&#125;</span>_<span class="subst">$(date +%Y-%m-%d)</span>.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到MySQL数据库</span></span><br><span class="line">mysql -h<span class="string">&quot;<span class="variable">$HOST</span>&quot;</span> -u<span class="string">&quot;<span class="variable">$DB_USER</span>&quot;</span> -p<span class="string">&quot;<span class="variable">$DB_PASSWORD</span>&quot;</span> <span class="string">&quot;<span class="variable">$DB_NAME</span>&quot;</span> -e <span class="string">&quot;SELECT \`<span class="variable">$COLUMN_NAME</span>\` FROM \`<span class="variable">$TABLE_NAME</span>\`&quot;</span> &gt; <span class="string">&quot;<span class="variable">$OUTPUT_FILE</span>&quot;</span></span><br><span class="line"></span><br><span class="line">sed -i <span class="string">&#x27;1d&#x27;</span> <span class="variable">$OUTPUT_FILE</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Column \`<span class="variable">$COLUMN_NAME</span>\` from table \`<span class="variable">$TABLE_NAME</span>\` has been exported to <span class="variable">$OUTPUT_FILE</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> <span class="string">&quot;<span class="variable">$OUTPUT_FILE</span>&quot;</span> <span class="variable">$EXPORT_DIR</span>/threatips.txt</span><br></pre></td></tr></table></figure>

<ul>
<li><p>定时推送</p>
<p>根据部署情况选择Github、OSS、MinIO对象存储等途径上传threatips.txt文件，使用脚本定时推送更新即可。</p>
</li>
</ul>
<h2 id="防御效果："><a href="#防御效果：" class="headerlink" title="防御效果："></a>防御效果：</h2><p><img data-src="/hfish-safeline/image-20240201150403087.png" alt="image-20240201150403087"></p>
<p><img data-src="/hfish-safeline/image-20240201150428430.png" alt="image-20240201150428430"></p>
<p><img data-src="/hfish-safeline/image-20240201150331151.png" alt="image-20240201150331151"></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Melt_Tscci
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://blog.ceobe.cn/hfish-safeline/" title="雷池Safeline&amp;HFish主动防御方案">https://blog.ceobe.cn/hfish-safeline/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E5%AE%89%E5%85%A8%E5%90%88%E8%A7%84/" rel="tag"># 安全合规</a>
              <a href="/tags/WAF/" rel="tag"># WAF</a>
              <a href="/tags/%E8%9C%9C%E7%BD%90%E6%8A%80%E6%9C%AF/" rel="tag"># 蜜罐技术</a>
              <a href="/tags/%E4%B8%BB%E5%8A%A8%E9%98%B2%E5%BE%A1/" rel="tag"># 主动防御</a>
              <a href="/tags/%E4%BA%8B%E4%BB%B6%E5%93%8D%E5%BA%94/" rel="tag"># 事件响应</a>
              <a href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" rel="tag"># 防火墙</a>
              <a href="/tags/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%AE%89%E5%85%A8/" rel="tag"># 应用程序安全</a>
              <a href="/tags/%E9%A3%8E%E9%99%A9%E8%AF%84%E4%BC%B0/" rel="tag"># 风险评估</a>
              <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="tag"># 网络安全</a>
              <a href="/tags/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB/" rel="tag"># 钓鱼攻击</a>
              <a href="/tags/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/" rel="tag"># 恶意软件</a>
              <a href="/tags/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/" rel="tag"># 威胁情报</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/harbor-trivy/" rel="prev" title="数据仓库&镜像漏洞扫描器安装部署">
                  <i class="fa fa-angle-left"></i> 数据仓库&镜像漏洞扫描器安装部署
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/dozzle/" rel="next" title="使用Dozzle审计容器日志">
                  使用Dozzle审计容器日志 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备20026372号-4 </a>
      <img src="/gongan.png" alt=""><a href="https://beian.mps.gov.cn/#/query/webSearch?code=33019202002361" rel="noopener" target="_blank">浙公网安备33019202002361号 </a>
  </div>
  <div class="copyright">
    &copy; 2022 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">_Melt_Tscci</span>
  
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
   
    <span title="站点总字数">62k</span>
  </span>
  
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">1:52</span>
  </span>

  <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>

</div><div>
<a style="display:inline-block" title="页面响应时间"><img src="https://monitor.ceobe.cn/api/badge/8/response?style=flat-square" style="cursor: text">
</a>
<a style="display:inline-block" title="评论平台状态"><img src="https://monitor.ceobe.cn/api/badge/3/uptime/24?labelPrefix=Waline&labelSuffix=h&style=flat-square" style="cursor: text">
</a>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://blog.ceobe.cn/hfish-safeline/"}</script>
  <script src="/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.ceobe.cn/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"visitor":false,"dark":false,"login":"enable","wordLimit":0,"pageSize":10,"highlight":true,"meta":["nick","mail"],"requiredMeta":[],"placeholder":"随便说点什么喵～o(=•ェ•=)m \\n没有登录也是完全没问题的哦～","copyright":false,"emoji":["https://unpkg.com/@waline/emojis@1.1.0/bilibili"],"el":"#waline","comment":true,"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","path":"/hfish-safeline/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>
<meta name="viewport" content="width=device-width">
<style>

html .sakana-box{
  position: fixed;
  right: 0;
  bottom: 0;
  
  transform-origin: 100% 100%; /* 从右下开始变换 */
}
</style>

<div class="sakana-box"></div>

<script src="https://cdn.jsdelivr.net/npm/sakana@1.0.8"></script>
<script>
// 取消静音
Sakana.setMute(true);

// 启动
Sakana.init({
  el:         '.sakana-box',     // 启动元素 node 或 选择器
  scale:      .5,                // 缩放倍数
  canSwitchCharacter: true,      // 允许换角色
  scale:      0.425,             // 缩放倍数
  character:  'takina',          // 启动角色 'chisato','takina' 
});
</script>
</body>
</html>
